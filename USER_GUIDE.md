# ZapEditor ユーザーガイド

ZapEditorの使い方を詳しく説明します。

## 目次

- [基本的な使い方](#基本的な使い方)
- [ファイル操作](#ファイル操作)
- [表示モード](#表示モード)
- [言語切替](#言語切替)
- [コード実行](#コード実行)
- [キーボードショートカット](#キーボードショートカット)
- [Tips & Tricks](#tips--tricks)

## 基本的な使い方

### 起動方法

#### Windows
`ZapEditor.exe`をダブルクリックします。

#### macOS / Linux
ターミナルから実行：
```bash
./ZapEditor
```

または、Finderやファイルマネージャーからダブルクリックします。

### ウィンドウの構成

ZapEditorのメインウィンドウは以下の要素で構成されています：

```
┌─────────────────────────────────────────┐
│ メニューバー                              │
├─────────────────────────────────────────┤
│ ツールバー                                │
├───────┬─────────────────────────────────┤
│       │                                 │
│ ファイル │      エディタ領域                │
│ リスト  │                                 │
│       │                                 │
├───────┴─────────────────────────────────┤
│ ステータスバー                             │
└─────────────────────────────────────────┘
```

## ファイル操作

### ファイルを開く

**方法1: メニューから**
1. メニューバーの「ファイル」→「開く」を選択
2. ファイル選択ダイアログでファイルを選択
3. 「開く」ボタンをクリック

**方法2: ツールバーから**
- ツールバーの「開く」ボタンをクリック

**方法3: キーボードショートカット**
- Windows/Linux: `Ctrl + O`
- macOS: `Cmd + O`

**対応ファイル形式**
- テキストファイル（.txt）
- ソースコードファイル（.fs, .cs, .py, .js等）
- その他のテキストベースファイル

### ファイルを保存

**新規ファイルの保存**
1. メニューバーの「ファイル」→「名前を付けて保存」
2. 保存場所とファイル名を指定
3. 「保存」ボタンをクリック

**既存ファイルの上書き保存**
- メニューバーの「ファイル」→「保存」
- または、ツールバーの「保存」ボタン
- キーボードショートカット: `Ctrl + S` (Windows/Linux) / `Cmd + S` (macOS)

### 新規ファイル

メニューバーの「ファイル」→「新規」で新しいファイルを作成します。

## 表示モード

### 縦書き/横書きの切替

**v1.2.0の新機能**: テキストの表示方向を縦書きと横書きで切り替えられます。

**切替方法**

**方法1: メニューから**
1. メニューバーの「表示」をクリック
2. 「縦書き/横書き切替」を選択

**方法2: ツールバーから**
- ツールバーの「横書き」または「縦書き」ボタンをクリック

**注意事項**
- 縦書きモードでは、テキストが90度回転して表示されます
- スクロールバーも同様に回転します
- 完全な縦書きレイアウトエンジンではなく、横書きテキストを回転させた表示です

### 使用例

**縦書きが便利な場面**
- 日本語の小説や詩の執筆
- 縦書きで確認したい文書の編集
- 縦書きレイアウトのプレビュー

**横書きが便利な場面**
- プログラミングコードの編集
- 英数字中心の文書
- 通常のテキスト編集作業

## 言語切替

ZapEditorのUIは3つの言語に対応しています。

### サポート言語

- 🇯🇵 日本語（Japanese）
- 🇬🇧 英語（English）
- 🇨🇳 中国語（Chinese/中文）

### 言語の切替方法

1. メニューバーの「表示」→「言語切替」を選択
2. 希望の言語を選択（日本語/English/中文）

**切替直後の変化**
- メニュー項目
- ツールバーボタンのツールチップ
- ステータスバーのメッセージ
- ダイアログのテキスト

すべてが選択した言語に即座に切り替わります。

## コード実行

ZapEditorでは、エディタ内で直接コードを実行できます。

### サポート言語

- **F#**: F#スクリプトの実行
- **C#**: C#コードスニペットの実行
- **Python**: Pythonスクリプトの実行
- **JavaScript**: Node.jsでの実行

### 実行方法

1. エディタにコードを記述
2. メニューバーの「実行」→「コードを実行」を選択
3. または、ツールバーの「実行」ボタンをクリック

### 必要な環境

コード実行機能を使用するには、対応する言語の実行環境が必要です：

- **F#**: .NET SDK 9.0（ZapEditorに含まれる）
- **C#**: .NET SDK 9.0（ZapEditorに含まれる）
- **Python**: Python 3.x（別途インストールが必要）
- **JavaScript**: Node.js 18+（別途インストールが必要）

詳細は[INSTALL.md](INSTALL.md)の「オプション機能のセットアップ」セクションを参照してください。

### デバッグモード

「実行」→「デバッグ」を選択すると、より詳細なエラー情報が表示されます。

## 編集機能

### 基本操作

- **元に戻す**: `Ctrl + Z` (Windows/Linux) / `Cmd + Z` (macOS)
- **やり直す**: `Ctrl + Y` (Windows/Linux) / `Cmd + Shift + Z` (macOS)
- **切り取り**: `Ctrl + X` (Windows/Linux) / `Cmd + X` (macOS)
- **コピー**: `Ctrl + C` (Windows/Linux) / `Cmd + C` (macOS)
- **貼り付け**: `Ctrl + V` (Windows/Linux) / `Cmd + V` (macOS)
- **すべて選択**: `Ctrl + A` (Windows/Linux) / `Cmd + A` (macOS)

### シンタックスハイライト

コードファイルを開くと、自動的にシンタックスハイライトが適用されます。

**サポート言語**
- F#
- C#
- Python
- JavaScript
- TypeScript
- HTML
- CSS
- JSON
- XML
- Markdown
- SQL
- Java
- C++
- Go
- Rust

### 行番号

エディタの左側に行番号が表示されます。これはコードの閲覧やデバッグに便利です。

## キーボードショートカット

### ファイル操作

| 機能 | Windows/Linux | macOS |
|------|---------------|-------|
| 新規 | `Ctrl + N` | `Cmd + N` |
| 開く | `Ctrl + O` | `Cmd + O` |
| 保存 | `Ctrl + S` | `Cmd + S` |
| 名前を付けて保存 | `Ctrl + Shift + S` | `Cmd + Shift + S` |
| 終了 | `Alt + F4` | `Cmd + Q` |

### 編集操作

| 機能 | Windows/Linux | macOS |
|------|---------------|-------|
| 元に戻す | `Ctrl + Z` | `Cmd + Z` |
| やり直す | `Ctrl + Y` | `Cmd + Shift + Z` |
| 切り取り | `Ctrl + X` | `Cmd + X` |
| コピー | `Ctrl + C` | `Cmd + C` |
| 貼り付け | `Ctrl + V` | `Cmd + V` |
| すべて選択 | `Ctrl + A` | `Cmd + A` |

### コード実行

| 機能 | Windows/Linux | macOS |
|------|---------------|-------|
| コードを実行 | `F5` | `F5` |
| デバッグ | `F6` | `F6` |

## Tips & Tricks

### 1. 大きなファイルを扱う

ZapEditorは比較的小さなファイル（数千行程度）に最適化されています。非常に大きなファイル（数万行以上）を開く場合は、パフォーマンスが低下する可能性があります。

### 2. 文字コードの扱い

ZapEditorはUTF-8エンコーディングを推奨します。他のエンコーディングのファイルは正しく表示されない場合があります。

### 3. カスタムテーマ

現在、ZapEditorはDark Plusテーマを使用しています。将来のバージョンでテーマのカスタマイズ機能を追加予定です。

### 4. 自動保存

現在、自動保存機能はサポートされていません。定期的に手動で保存することをお勧めします。

### 5. 複数ファイルの同時編集

現在のバージョンでは、一度に1つのファイルのみを編集できます。タブ機能は今後のバージョンで追加予定です。

### 6. プラグイン機能

将来のバージョンでプラグインシステムを実装予定です。ご期待ください！

## トラブルシューティング

### ファイルが開けない

**症状**: ファイル選択ダイアログでファイルを選択しても開けない

**解決方法**:
1. ファイルが他のアプリケーションで開かれていないか確認
2. ファイルの読み取り権限があるか確認
3. ステータスバーにエラーメッセージが表示されていないか確認

### コードが実行できない

**症状**: 「実行」ボタンを押しても何も起こらない

**解決方法**:
1. 対応する言語の実行環境がインストールされているか確認
2. 環境変数PATHに実行ファイルのパスが含まれているか確認
3. デバッグモードで実行して、エラーメッセージを確認

### 縦書きモードで文字が読めない

**症状**: 縦書きモードに切り替えると文字が読みにくい

**解決方法**:
- 横書きモードに戻してください
- 縦書きモードは日本語テキストに最適化されています
- フォントサイズを調整すると読みやすくなる場合があります

## サポート

追加のサポートが必要な場合：

- 📖 [README.md](README.md)を確認
- 🐛 バグを発見した場合は[Issues](https://github.com/SilentMalachite/ZapEditor/issues)で報告
- 💬 質問がある場合は[Discussions](https://github.com/SilentMalachite/ZapEditor/discussions)で質問
- 🤝 貢献したい場合は[CONTRIBUTING.md](CONTRIBUTING.md)を確認

---

**Happy Editing! ✍️**
